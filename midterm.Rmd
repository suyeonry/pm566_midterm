---
title: "Midterm"
author: "Suyeon Ryu"
date: '2020 10 5'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, eval=TRUE, echo=FALSE}
library(tidyverse)
library(ggplot2)
library(data.table)
library(dplyr)

midt<- data.table::fread("C:/Users/suyeo/PM566/midterm/data/BYAREA.txt")

head(midt)
str(midt)
summary(midt)

cln <- midt[midt$SITE == "Colon and Rectum"]

cln_mort <- cln[cln$EVENT_TYPE == "Mortality"]
cln_inc <- cln[cln$EVENT_TYPE == "Incidence"]

# Noticed some rates are still characters. In order to plot, need to change to numeric!

cln_mort <- cln_mort %>% mutate(
  CRUDE_RATE = as.numeric(CRUDE_RATE),
  YEAR = as.numeric(YEAR)
)


cln_inc <- cln_inc %>% mutate(
  CRUDE_RATE = as.numeric(CRUDE_RATE),
  YEAR = as.numeric(YEAR)
)


# checking and removing missing values 
cln_mort %>%
  select(everything()) %>%
  summarise_all(funs(sum(is.na(.))))

cln_inc %>%
  select(everything()) %>%
  summarise_all(funs(sum(is.na(.))))

cln_mort <- na.omit(cln_mort)
cln_inc <- na.omit(cln_inc)




```


```{r, eval=TRUE}


# trimming down (subsetting) the data because it is too big

cln_inc <- cln_inc %>% group_by(CRUDE_RATE) %>%
  slice(seq(1, n(), by = 20))
cln_mort <-  cln_mort %>% group_by(CRUDE_RATE) %>%
  slice(seq(1, n(), by = 20))

# Trend of colon cancer incidence and mortality over the years (maybe line graph)

ggplot(cln_mort, aes(x=YEAR, y=CRUDE_RATE))+
  geom_point(color="red")+
  theme_minimal()+
  geom_smooth(method="loess", color="red", fill="darkred")+
  ggtitle("U.S. Colon Cancer Mortality Crude Rate")


ggplot(cln_inc, aes(x=YEAR, y=CRUDE_RATE))+
  geom_point(color="blue")+
  theme_minimal()+
  geom_smooth(method="loess")+
  ggtitle("U.S. Colon Cancer Incidence Crude Rate")



```



```{r}
#EAST versus WEST

#EAST will include New York, Pennsylvania, New Jersey, Virginia, North and South Carolina, Georgia
#WEST will include Washington, Oregon, California

us_map <- map_data("state")

east_states <- c("new york", "pennsylvania","new jersey","virginia","north carolina","south carolina","georgia")
west_states <- c("washington","oregon","california")

ggplot(us_map, aes(x=long, y=lat, group = group)) +
  geom_polygon(fill="grey", colour = "white") +
  geom_polygon(fill="palevioletred1", data = filter(us_map, region %in% east_states)) +
  geom_polygon(fill="mediumpurple", data = filter(us_map, region %in% west_states))+
  ggtitle("U.S Colon Cancer Comparison Covered Area East versus West")


#make new variables for east and west states

cln_inc$westeast <- ifelse(cln_inc$AREA == "New York"|cln_inc$AREA == "Pennsylvania"|cln_inc$AREA == "New Jersey"|cln_inc$AREA == "Virginia"|cln_inc$AREA == "North Carolina"|cln_inc$AREA == "South Carolina"|cln_inc$AREA == "Georgia", "East Coast",
                           ifelse(cln_inc$AREA =="Washington"|cln_inc$AREA =="Oregon"|cln_inc$AREA == "California", "West Coast","Not Considered" ))






p <- ggplot(data=cln_inc, aes(x=YEAR, y=CRUDE_RATE, fill=westeast))+
  geom_bar(stat="identity", color="black", position=position_dodge())+
  scale_fill_manual(values=c("palevioletred1","#999999","mediumpurple"))+
  theme_minimal()


p
a<-cln_inc[!(cln_inc$westeast=="Not Considered"),]
a <- ggplot(data=a, aes(x=YEAR, y=CRUDE_RATE, fill=westeast))+
  geom_bar(stat="identity", color="black", position=position_dodge())+
  scale_fill_manual(values=c("palevioletred1","#999999","mediumpurple"))+
  theme_minimal()
a
```

```{r}

```



```{r}
# colon cancer trend in young people

```


```{r}
# colon cancer comparison between west versus east , incidence rate, mortality rate

```

